document.addEventListener("alpine:init",()=>{Alpine.data("wnca",()=>({init(){this.colors=JSON.parse(this.$refs.colors_json.innerHTML),this.$watch("val.text",this.updateFontSize.bind(this)),this.$watch("val.text",this.updateSpelling.bind(this)),this.$watch("val.font",this.updateFontSize.bind(this)),this.$watch("state.spelling",(t,e)=>e!==t&&this.updateFonts()),this._fonts=JSON.parse(this.$refs.fonts_json.innerHTML),this.updateFonts()},_fonts:[],fonts:[],colors:[],getColorByHex(t){return this.colors.find(e=>e.color==t)},tabs:["Text","Font","Color"],activeTab:"Text",cache:{loadedFonts:[]},state:{spelling:"lat",font:null,color:{preview:"",detailPreview:""},text:{light:!0,align:"center",fontSize:"",dragStart:{x:0,y:0},x:"auto",y:"17%"}},val:{text:"",font:"",color:""},setTab(t){this.activeTab=t},async setFont(t){this.cache.loadedFonts.includes(t.name)||document.fonts.add(await new FontFace(t.name,`url(${t.link})`,{style:"normal",weight:700}).load()),this.val.font=t.name,this.state.font=t,this.updateFontSize()},async setColor(t){this.state.color=t,this.val.color=t.color},getLightShadow(){return["white 0px 0px 5px","white 0px 0px 10px",`${this.val.color} 0px 0px 20px`,`${this.val.color} 0px 0px 30px`,`${this.val.color} 0px 0px 40px`,`${this.val.color} 0px 0px 55px`,`${this.val.color} 0px 0px 75px`].join(", ")},getDarkShadow(){let e=RGB.from_hex("#aaa"),s=[`${e.dim(10).toHex()} 0px 1px 0px`,`${e.dim(10*2).toHex()} 0px 2px 0px`,`${e.dim(10*3).toHex()} 0px 3px 0px`,`${e.dim(10*4).toHex()} 0px 4px 0px`,"rgba(0, 0, 0, 0.23) 0px 0px 5px","rgba(0, 0, 0, 0.43) 0px 1px 3px","rgba(0, 0, 0, 0.4) 1px 4px 6px","rgba(0, 0, 0, 0.38) 0px 5px 10px","rgba(0, 0, 0, 0.25) 3px 7px 12px"];return console.log(s.join(", ")),s.join(", ")},toggleLight(t){this.state.text.light=t},onTextDrag(t){let e=this.$refs.text,s=this.$refs.preview;t.preventDefault();let i=10,o=this.state.text.dragStart.x-t.clientX,n=this.state.text.dragStart.y-t.clientY;this.state.text.dragStart.x=t.clientX,this.state.text.dragStart.y=t.clientY;let a=Math.min(s.clientHeight-e.clientHeight-i,Math.max(0+i,e.offsetTop-n)),l=Math.min(s.clientWidth-e.clientWidth-i,Math.max(0+i,e.offsetLeft-o));this.state.text.y=a+"px",this.state.text.x=l+"px"},get fontBaseSize(){return this.state.font.base_size},updateFonts(){let t=this.state.font==null,e=!t&&this.state.font.spelling.includes(this.state.spelling);this.fonts=this._fonts.filter(s=>s.spelling.includes(this.state.spelling)),(t||!e)&&this.setFont(this.fonts[0])},updateSpelling(){this.state.spelling=this.val.text.match(/[а-я]/i)?"cyr":"lat"},updateFontSize(){let t=this.$refs.preview.clientWidth,e=this.$refs.text.clientWidth;this.state.text.fontSize=Math.min(this.fontBaseSize,this.state.text.fontSize/(e/t)),this.val.text.length==0&&(this.state.text.fontSize=this.fontBaseSize)},text:{["x-ref"]:"text",":style":`{
          top: state.text.y,
          left: state.text.x,
          fontFamily: val.font,
          fontSize: state.text.fontSize + 'px',
          textAlign: state.text.align,
          textShadow: state.text.light ? getLightShadow() : getDarkShadow(),
          color: state.text.light ? 'white' : val.color,
        }`,"x-html":"val.text.replaceAll('\\n', '<br>') || 'Your Text'",["@mousedown"](t){t=t||window.event,t.preventDefault(),this.state.text.dragStart.x=t.clientX,this.state.text.dragStart.y=t.clientY,document.onmouseup=()=>{document.onmouseup=null,document.onmousemove=null},document.onmousemove=this.onTextDrag.bind(this)}}}))});
//# sourceMappingURL=main.js.map
