{
  "version": 3,
  "sources": ["../src/index.js"],
  "sourcesContent": ["document.addEventListener(\"alpine:init\", () => {\n  Alpine.data(\"wnca\", () => ({\n    init() {\n      this.colors = JSON.parse(this.$refs.colors_json.innerHTML);\n      this.$watch(\"val.text\", this.updateFontSize.bind(this));\n      this.$watch(\"val.text\", this.updateSpelling.bind(this));\n      this.$watch(\"val.font\", this.updateFontSize.bind(this));\n      this.$watch(\n        \"state.spelling\",\n        (ov, nv) => nv !== ov && this.updateFonts()\n      );\n\n      this._fonts = JSON.parse(this.$refs.fonts_json.innerHTML);\n      this.updateFonts();\n    },\n    _fonts: [],\n    fonts: [],\n    colors: [],\n\n    getColorByHex(hex) {\n      return this.colors.find((i) => i.color == hex);\n    },\n\n    tabs: [\"Text\", \"Font\", \"Color\"],\n    activeTab: \"Text\",\n    cache: {\n      loadedFonts: [],\n    },\n    state: {\n      spelling: \"lat\",\n      font: null,\n      color: {\n        preview: \"\",\n        detailPreview: \"\",\n      },\n      text: {\n        light: true,\n        align: \"center\",\n        fontSize: \"\",\n        dragStart: {\n          x: 0,\n          y: 0,\n        },\n        x: \"auto\",\n        y: \"17%\",\n      },\n    },\n\n    // FormValues\n    val: {\n      text: \"\",\n      font: \"\",\n      color: \"\",\n    },\n\n    setTab(tab) {\n      this.activeTab = tab;\n    },\n\n    async setFont(font) {\n      if (!this.cache.loadedFonts.includes(font.name)) {\n        document.fonts.add(\n          await new FontFace(font.name, `url(${font.link})`, {\n            style: \"normal\",\n            weight: 700,\n          }).load()\n        );\n      }\n      this.val.font = font.name;\n      this.state.font = font;\n      this.updateFontSize();\n    },\n    async setColor(color) {\n      this.state.color = color;\n      this.val.color = color.color;\n    },\n    getLightShadow() {\n      const shadows = [\n        `white 0px 0px 5px`,\n        `white 0px 0px 10px`,\n        `${this.val.color} 0px 0px 20px`,\n        `${this.val.color} 0px 0px 30px`,\n        `${this.val.color} 0px 0px 40px`,\n        `${this.val.color} 0px 0px 55px`,\n        `${this.val.color} 0px 0px 75px`,\n      ];\n      return shadows.join(\", \");\n    },\n    getDarkShadow() {\n      const dimStep = 10;\n      const color = RGB.from_hex(\"#aaa\");\n      const shadows = [\n        `${color.dim(dimStep).toHex()} 0px 1px 0px`,\n        `${color.dim(dimStep * 2).toHex()} 0px 2px 0px`,\n        `${color.dim(dimStep * 3).toHex()} 0px 3px 0px`,\n        `${color.dim(dimStep * 4).toHex()} 0px 4px 0px`,\n        `rgba(0, 0, 0, 0.23) 0px 0px 5px`,\n        `rgba(0, 0, 0, 0.43) 0px 1px 3px`,\n        `rgba(0, 0, 0, 0.4) 1px 4px 6px`,\n        `rgba(0, 0, 0, 0.38) 0px 5px 10px`,\n        `rgba(0, 0, 0, 0.25) 3px 7px 12px`,\n      ];\n      console.log(shadows.join(\", \"));\n      return shadows.join(\", \");\n    },\n    toggleLight(status) {\n      this.state.text.light = status;\n    },\n\n    onTextDrag(e) {\n      const $el = this.$refs.text;\n      const $preview = this.$refs.preview;\n\n      e.preventDefault();\n      // calculate the new cursor position:\n      const innerBorderOffset = 10;\n      const pos1 = this.state.text.dragStart.x - e.clientX;\n      const pos2 = this.state.text.dragStart.y - e.clientY;\n      this.state.text.dragStart.x = e.clientX;\n      this.state.text.dragStart.y = e.clientY;\n\n      const top = Math.min(\n        $preview.clientHeight - $el.clientHeight - innerBorderOffset,\n        Math.max(0 + innerBorderOffset, $el.offsetTop - pos2)\n      );\n      const left = Math.min(\n        $preview.clientWidth - $el.clientWidth - innerBorderOffset,\n        Math.max(0 + innerBorderOffset, $el.offsetLeft - pos1)\n      );\n      // set the element's new position:\n      this.state.text.y = top + \"px\";\n      this.state.text.x = left + \"px\";\n    },\n\n    get fontBaseSize() {\n      return this.state.font.base_size;\n    },\n\n    updateFonts() {\n      const fontIsNull = this.state.font == null;\n      const fontHasCurrentSpelling =\n        !fontIsNull && this.state.font.spelling.includes(this.state.spelling);\n\n      this.fonts = this._fonts.filter((font) =>\n        font.spelling.includes(this.state.spelling)\n      );\n      if (fontIsNull || !fontHasCurrentSpelling) this.setFont(this.fonts[0]);\n    },\n\n    updateSpelling() {\n      this.state.spelling = this.val.text.match(/[\u0430-\u044F]/i) ? \"cyr\" : \"lat\";\n    },\n    updateFontSize() {\n      const previewWidth = this.$refs.preview.clientWidth;\n      const textWidth = this.$refs.text.clientWidth;\n\n      this.state.text.fontSize = Math.min(\n        this.fontBaseSize,\n        this.state.text.fontSize / (textWidth / previewWidth)\n      );\n\n      if (this.val.text.length == 0)\n        this.state.text.fontSize = this.fontBaseSize;\n    },\n\n    text: {\n      [\"x-ref\"]: \"text\",\n\n      \":style\": `{\n          top: state.text.y,\n          left: state.text.x,\n          fontFamily: val.font,\n          fontSize: state.text.fontSize + 'px',\n          textAlign: state.text.align,\n          textShadow: state.text.light ? getLightShadow() : getDarkShadow(),\n          color: state.text.light ? 'white' : val.color,\n        }`,\n      \"x-html\": \"val.text.replaceAll('\\\\n', '<br>') || 'Your Text'\",\n      [\"@mousedown\"](e) {\n        e = e || window.event;\n        e.preventDefault();\n        // get the mouse cursor position at startup:\n        this.state.text.dragStart.x = e.clientX;\n        this.state.text.dragStart.y = e.clientY;\n        document.onmouseup = () => {\n          document.onmouseup = null;\n          document.onmousemove = null;\n        };\n        // call a function whenever the cursor moves:\n        document.onmousemove = this.onTextDrag.bind(this);\n      },\n    },\n  }));\n});\n"],
  "mappings": "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",
  "names": ["ov", "nv", "hex", "i", "tab", "font", "color", "shadows", "status", "e", "$el", "$preview", "innerBorderOffset", "pos1", "pos2", "top", "left", "fontIsNull", "fontHasCurrentSpelling", "previewWidth", "textWidth"]
}
